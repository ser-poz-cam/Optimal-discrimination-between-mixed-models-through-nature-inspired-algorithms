(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    145613,       3444]
NotebookOptionsPosition[    140842,       3358]
NotebookOutlinePosition[    141366,       3377]
CellTagsIndexPosition[    141323,       3374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.920366836759123*^9, 3.9203668377973747`*^9}},
 FontSize->12,ExpressionUUID->"981b4710-4d3e-4d7a-a8a9-40d82f65511c"],

Cell[CellGroupData[{

Cell["Model parameters", "Subtitle",
 CellChangeTimes->{{3.9200387769996843`*^9, 3.920038779652131*^9}, {
  3.9434214247234993`*^9, 3.943421433870997*^9}, {3.9434222491975527`*^9, 
  3.943422249610887*^9}},ExpressionUUID->"a006670b-50a0-4485-aec8-\
b73945db9145"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndiet", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nexercise", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npharm", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", " ", "=", " ", "75"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "points", " ", "of", " ", "the", " ", "design"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"iter", "[", "k_", "]"}], ":=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"iter", ",", "k"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumlist", "[", "list_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.920029230743462*^9, 3.920029241691874*^9}, {
   3.9200300421173067`*^9, 3.920030080188014*^9}, {3.920030115406427*^9, 
   3.9200301209008636`*^9}, {3.920030617086804*^9, 3.9200309350330467`*^9}, {
   3.920031034443473*^9, 3.920031034853763*^9}, {3.92003110653848*^9, 
   3.920031131651729*^9}, {3.920031165760758*^9, 3.920031241735449*^9}, {
   3.920031504157764*^9, 3.92003150649302*^9}, {3.920031603721416*^9, 
   3.9200316593939857`*^9}, {3.9200319459804983`*^9, 3.920031947568809*^9}, {
   3.9200322171449537`*^9, 3.920032233433901*^9}, 3.920037708388085*^9, 
   3.920038790599786*^9, {3.920038833573165*^9, 3.920038844230785*^9}, 
   3.920038923007258*^9, {3.9200391364064493`*^9, 3.9200391421820183`*^9}, {
   3.920039508990087*^9, 3.920039509499147*^9}, {3.920039620955432*^9, 
   3.920039622145459*^9}, {3.920041483395454*^9, 3.920041490310231*^9}, {
   3.920043969016015*^9, 3.9200439876527767`*^9}, {3.920051380261203*^9, 
   3.920051396168873*^9}, {3.920088037299972*^9, 3.9200880377012787`*^9}, {
   3.920088203969829*^9, 3.9200882161359*^9}, 3.920088562764106*^9, 
   3.92008958731787*^9, 3.920090465084236*^9, 3.920090764218295*^9, {
   3.921039019182228*^9, 3.921039025498643*^9}, {3.921039522276513*^9, 
   3.921039542062047*^9}, 3.921040220509213*^9, {3.921041517278658*^9, 
   3.92104152187717*^9}, 3.921041662379827*^9, 3.921043450929936*^9, {
   3.921044166719949*^9, 3.921044167063692*^9}, {3.921047486022903*^9, 
   3.9210474899842243`*^9}, 3.9210475313881903`*^9, {3.921047590250454*^9, 
   3.9210475948731422`*^9}, {3.921047769444228*^9, 3.921047776038005*^9}, 
   3.921047916845745*^9, {3.9210713950859528`*^9, 3.921071396796557*^9}, {
   3.921080532452218*^9, 3.921080546820904*^9}, {3.9211261220774717`*^9, 
   3.921126143313985*^9}, 3.921127448473971*^9, {3.9211667323220367`*^9, 
   3.921166738955563*^9}, {3.921166791883184*^9, 3.9211667946427383`*^9}, {
   3.921166922128182*^9, 3.9211669244640913`*^9}, {3.921167291778133*^9, 
   3.9211672918693647`*^9}, {3.921167898494041*^9, 3.921167904939065*^9}, {
   3.9211724590484123`*^9, 3.921172459455565*^9}, 3.921174091668642*^9, {
   3.921174226492941*^9, 3.9211742270840816`*^9}, {3.921174353057119*^9, 
   3.9211743532303534`*^9}, 3.921174409253007*^9, {3.921206890727964*^9, 
   3.921206891987587*^9}, 3.921216560124352*^9, {3.921216638889207*^9, 
   3.921216639197349*^9}, {3.921216802074441*^9, 3.921216802527421*^9}, {
   3.921290205286565*^9, 3.921290205709437*^9}, {3.921290359008589*^9, 
   3.921290359991157*^9}, {3.921291902137619*^9, 3.921291902672572*^9}, {
   3.9217233506579847`*^9, 3.921723351479485*^9}, {3.9217336289655*^9, 
   3.921733631562932*^9}, {3.921751568228629*^9, 3.921751568777233*^9}, {
   3.9217522484371977`*^9, 3.921752249152679*^9}, {3.9434222701673203`*^9, 
   3.9434223075878973`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"01a24b02-385b-40ba-9a21-e75c7bbe83ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the design Space", "Subtitle",
 CellChangeTimes->{{3.920038819281802*^9, 3.920038821739715*^9}, {
  3.9434223318956203`*^9, 
  3.9434223404557*^9}},ExpressionUUID->"18a553a4-de38-49f8-93f4-74d9d1865a33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"point", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"iter", ",", "1", ",", 
           RowBox[{"ndiet", "+", "nexercise", "+", "npharm", "-", "3"}]}], 
          "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "i", "\[LessEqual]", "ndiet"}], ")"}], 
        " ", "\[And]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "j", "\[LessEqual]", "nexercise"}], " ",
          ")"}], " ", "\[And]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "npharm"}], 
         ")"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}], "=", "1"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"ndiet", "+", "j", "-", "2"}], "]"}], "]"}], "=", 
           "1"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"k", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"ndiet", "+", "nexercise", "+", "k", "-", "3"}], "]"}], 
            "]"}], "=", "1"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "list"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<Out of bounds\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Chi]", ":", " ", 
    RowBox[{"design", " ", "space"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"\[Chi]", ",", 
      RowBox[{"point", "[", 
       RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "ndiet"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "nexercise"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "npharm"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Complete", " ", "design"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Design", "[", "replicates_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Xi]", "=", 
       RowBox[{"{", "}"}]}], ",", "aux"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"\[Xi]", ",", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"replicates", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[Xi]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.920088289698083*^9, 3.9200883181726637`*^9}, {
   3.920088355688867*^9, 3.9200883809480553`*^9}, {3.9200884419968987`*^9, 
   3.920088785877431*^9}, {3.920088831536812*^9, 3.9200889077890787`*^9}, {
   3.920089842847266*^9, 3.9200899638728313`*^9}, {3.9210477850785427`*^9, 
   3.9210477915437202`*^9}, {3.921174095176114*^9, 3.9211740955721617`*^9}, 
   3.921290841130884*^9, {3.922944776232142*^9, 3.9229447774663687`*^9}, {
   3.9434222949422703`*^9, 3.94342230011411*^9}, {3.943422343074086*^9, 
   3.943422454005355*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"7b962d35-3595-42eb-ba4e-5866bd87e3c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["G1: Modelo sin interacciones", "Subtitle",
 CellChangeTimes->{{3.920035897571041*^9, 3.920035905616918*^9}, {
   3.920035972476656*^9, 3.920035974974237*^9}, {3.9200387596629*^9, 
   3.9200387633777018`*^9}, 3.920038892615951*^9, {3.9200904944573307`*^9, 
   3.920090495357387*^9}},ExpressionUUID->"08eb0796-0485-4f73-8a42-\
fb3ec2ee632a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Y", " ", "=", " ", 
    RowBox[{"\[Alpha]0", " ", "+", " ", 
     RowBox[{"Dieta_", "2", "*", "\[Alpha]1"}], " ", "+", " ", 
     RowBox[{"Ejercicio_", "2", "*", "\[Alpha]2"}], " ", "+", " ", 
     RowBox[{"F\[AAcute]rmaco_", "2", "*", "\[Alpha]3"}], " ", "+", " ", 
     RowBox[{"F\[AAcute]rmaco_", "3", "*", "\[Alpha]4"}]}]}], "   ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"G1", "[", "des_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aux", "=", "des"}], ",", " ", 
       RowBox[{"desfinal", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"desfinal", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"aux", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "desfinal"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.920035979064804*^9, 3.9200361037322283`*^9}, {
   3.9200361845012407`*^9, 3.920036223707703*^9}, {3.920036677610198*^9, 
   3.9200367007149267`*^9}, {3.921047824748938*^9, 3.921047865981852*^9}, {
   3.921081828962165*^9, 3.921081831570446*^9}, {3.921082420578389*^9, 
   3.921082423573777*^9}, {3.921127558097913*^9, 3.921127563754937*^9}, {
   3.9211726073032217`*^9, 3.921172647674776*^9}, {3.921172689670752*^9, 
   3.921172805563303*^9}, {3.9211728944413548`*^9, 3.9211729038947897`*^9}, {
   3.921174121454969*^9, 3.92117412181115*^9}, 3.921174238054234*^9, {
   3.921216590601377*^9, 3.92121659245424*^9}, 3.921290579119865*^9, {
   3.921290662037718*^9, 3.921290664841968*^9}, {3.921290917868826*^9, 
   3.921290934156747*^9}, 3.921292545230844*^9, {3.9217232775369*^9, 
   3.9217232807509947`*^9}, {3.9218952799204693`*^9, 3.921895293410708*^9}, 
   3.9434224678680487`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"505490e2-fb3d-4e75-b809-6510454e9534"]
}, Open  ]],

Cell[CellGroupData[{

Cell["G2: Interacci\[OAcute]n entre Dieta y Ejercicio", "Subtitle",
 CellChangeTimes->{{3.920036234238578*^9, 3.9200362463558493`*^9}, {
   3.920037668661127*^9, 3.9200376734286833`*^9}, {3.920038756028311*^9, 
   3.920038756500128*^9}, 
   3.920038894018394*^9},ExpressionUUID->"d017942a-430a-4265-9709-\
de66648d0738"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Y", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dieta", "*", "\[Alpha]1"}], " ", "+", " ", 
    RowBox[{"Ejercicio", "*", "\[Alpha]2"}], " ", "+", " ", 
    RowBox[{"F\[AAcute]rmaco", "*", "\[Alpha]3"}], " ", "+", " ", 
    RowBox[{"Dieta", "*", "Ejercicio", "*", "\[Alpha]4"}]}]}], "  ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.920036262462976*^9, 
  3.920036281174464*^9}},ExpressionUUID->"0a520ba8-eb2e-46eb-b816-\
b87ed2051195"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G2", "[", "des_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aux", "=", "des"}], ",", 
      RowBox[{"desfinal", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"aux", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", 
             RowBox[{"ndiet", "+", "j", "-", "1"}]}], "]"}], "]"}]}]}], "]"}],
        "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"ndiet", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"nexercise", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"desfinal", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"aux", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "desfinal"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.920036254678917*^9, 3.920036254754211*^9}, {
   3.920036768473668*^9, 3.9200369214175673`*^9}, {3.9200370722149878`*^9, 
   3.920037077331923*^9}, {3.920037235130776*^9, 3.920037282696015*^9}, {
   3.920037368022285*^9, 3.92003737539493*^9}, {3.920039689409977*^9, 
   3.920039689543528*^9}, {3.920090420938119*^9, 3.9200904407526827`*^9}, 
   3.9210478513428297`*^9, 3.9211275521717978`*^9, {3.921172914492803*^9, 
   3.921172924904224*^9}, {3.9211742463701487`*^9, 3.9211742466061573`*^9}, {
   3.921723283372036*^9, 3.921723285587109*^9}, {3.9218954042160587`*^9, 
   3.921895431975671*^9}, 3.9229455108843317`*^9, {3.943422470942429*^9, 
   3.9434224936657248`*^9}},ExpressionUUID->"824f3c61-1ed9-4c80-bb15-\
ed1f15e867d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["G3: Interacci\[OAcute]n entre Dieta y F\[AAcute]rmaco", "Subtitle",
 CellChangeTimes->{{3.920037655461637*^9, 3.920037664475595*^9}, {
   3.920038752788889*^9, 3.920038753260491*^9}, 
   3.920038895861908*^9},ExpressionUUID->"079fbfe8-9e5d-47a8-b916-\
8fa30e42cd10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G3", "[", "des_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aux", "=", "des"}], ",", 
      RowBox[{"desfinal", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"aux", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", 
             RowBox[{"ndiet", "+", "nexercise", "+", "j", "-", "2"}]}], "]"}],
            "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"ndiet", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"npharm", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"desfinal", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"aux", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "desfinal"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.920037680709463*^9, 3.9200377029281693`*^9}, {
   3.920039683493506*^9, 3.920039683594974*^9}, {3.920090591893238*^9, 
   3.920090604441533*^9}, 3.921047871290501*^9, {3.921127548099317*^9, 
   3.921127548115192*^9}, {3.921172951288541*^9, 3.921172985294866*^9}, {
   3.9211741413547497`*^9, 3.921174141635406*^9}, 3.9211742532191877`*^9, {
   3.921723289652439*^9, 3.921723294653055*^9}, {3.9434224980956497`*^9, 
   3.943422513737084*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"40f40e56-af8e-49b2-8bc8-83d7035300af"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.920037733512102*^9, 3.920037745743656*^9}, 
   3.920039682163571*^9},ExpressionUUID->"58675416-8a7f-40ce-96fc-\
0ceb0d04f51a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["G4: Interacci\[OAcute]n entre Ejercicio y F\[AAcute]rmaco", "Subtitle",
 CellChangeTimes->{{3.920037806749464*^9, 3.920037817334708*^9}, {
   3.920038749670948*^9, 3.920038750124412*^9}, 
   3.9200388976631317`*^9},ExpressionUUID->"89a06519-88bc-4c24-bcdc-\
3cf5948e6fb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G4", "[", "des_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aux", "=", "des"}], ",", 
      RowBox[{"desfinal", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"aux", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", 
             RowBox[{"ndiet", "+", "i", "-", "1"}]}], "]"}], "]"}], "*", 
          RowBox[{"aux", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", 
             RowBox[{"ndiet", "+", "nexercise", "+", "j", "-", "2"}]}], "]"}],
            "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nexercise", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"npharm", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"desfinal", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"aux", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "desfinal"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.920037822211783*^9, 3.920037841035379*^9}, {
   3.920039703730424*^9, 3.9200397063863173`*^9}, {3.920090677290797*^9, 
   3.920090687214438*^9}, 3.92104787418922*^9, {3.921127538862308*^9, 
   3.921127543238575*^9}, {3.921172960947991*^9, 3.9211730006733627`*^9}, {
   3.921174145979341*^9, 3.921174146280645*^9}, 3.921174255787931*^9, {
   3.921723299663371*^9, 3.921723302225224*^9}, {3.943422520123394*^9, 
   3.9434225374069633`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"a72a4de1-6169-417f-a90c-2f958a0ec804"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.920037845300741*^9, 3.920037859959861*^9}, 
   3.92003970270401*^9},ExpressionUUID->"0f8a6e80-535e-458f-8f24-\
2d38f0b5cfba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gt: true/general model", "Subtitle",
 CellChangeTimes->{{3.920037959841737*^9, 3.920037974547262*^9}, {
  3.920038746542376*^9, 3.920038747004857*^9}, {3.92003889959842*^9, 
  3.9200389092762947`*^9}, {3.943422544273436*^9, 
  3.943422550512786*^9}},ExpressionUUID->"e6894912-ed91-40e9-ba0f-\
aa1384718b1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Gt", "[", "des_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aux", "=", "des"}], ",", 
       RowBox[{"desfinal", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "k1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", "i1"}], "]"}], "]"}], "*", 
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k1", ",", 
              RowBox[{"ndiet", "+", "j1", "-", "1"}]}], "]"}], "]"}]}]}], 
         "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "1", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"ndiet", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", "1", ",", 
          RowBox[{"nexercise", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Interacci\[OAcute]n", " ", "entre", " ", "dieta", " ", "y", " ", 
        "ejercicio"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "k2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", "i2"}], "]"}], "]"}], "*", 
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k2", ",", 
              RowBox[{"ndiet", "+", "nexercise", "+", "j2", "-", "2"}]}], 
             "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "1", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"ndiet", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j2", ",", "1", ",", 
          RowBox[{"npharm", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Interacci\[OAcute]n", " ", "entre", " ", "dieta", " ", "y", " ", 
        "f\[AAcute]rmaco"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "k3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k3", ",", 
              RowBox[{"ndiet", "+", "i3", "-", "1"}]}], "]"}], "]"}], "*", 
           RowBox[{"aux", "[", 
            RowBox[{"[", 
             RowBox[{"k3", ",", 
              RowBox[{"ndiet", "+", "nexercise", "+", "j3", "-", "2"}]}], 
             "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k3", ",", "1", ",", "m"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "1", ",", 
          RowBox[{"nexercise", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j3", ",", "1", ",", 
          RowBox[{"npharm", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Interacci\[OAcute]n", " ", "entre", " ", "ejercicio", " ", "y", " ", 
        "f\[AAcute]rmaco"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"desfinal", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"aux", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "desfinal"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.920038596020946*^9, 3.9200387108179493`*^9}, 
   3.920038910710026*^9, {3.920039115797615*^9, 3.920039116548311*^9}, {
   3.920039412272092*^9, 3.9200394465114603`*^9}, {3.920039716134634*^9, 
   3.920039716253832*^9}, {3.920090719910939*^9, 3.920090751443542*^9}, 
   3.921047877644651*^9, {3.921071702094144*^9, 3.9210717052603188`*^9}, {
   3.921127573718565*^9, 3.921127575655802*^9}, {3.921173005122312*^9, 
   3.921173036458994*^9}, {3.921174153395443*^9, 3.921174153719283*^9}, 
   3.921174258782317*^9, 3.92121969081789*^9, {3.921723305302351*^9, 
   3.9217233103346663`*^9}, 3.921732579841655*^9, 3.921895307531393*^9, 
   3.921895438633223*^9, 3.921895505692926*^9, {3.9230200331317368`*^9, 
   3.923020067023293*^9}, {3.943422553874012*^9, 3.9434225974680862`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"09c96665-1c52-478f-b1b1-7ba0597c7748"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MinKL-divergence", "Subtitle",
 CellChangeTimes->{{3.920039744585127*^9, 
  3.920039755754492*^9}},ExpressionUUID->"f2648e03-a333-4ad1-9251-\
3c33596375f3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalsuma", "=", 
   RowBox[{"m", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"totalsuma", "\[NotEqual]", "m"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Xi]approx", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]approx", "=", 
      RowBox[{"\[Xi]approx", "/", 
       RowBox[{"sumlist", "[", "\[Xi]approx", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]exact", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"m", "*", "\[Xi]approx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalsuma", "=", 
      RowBox[{"sumlist", "[", "\[Xi]exact", "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"nparameters", "=", 
  RowBox[{"Last", "[", 
   RowBox[{"Dimensions", "[", 
    RowBox[{"Gt", "[", 
     RowBox[{"Design", "[", "\[Xi]exact", "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"at", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", "nparameters"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9200397629901733`*^9, 3.920039779843055*^9}, 
   3.920039852618132*^9, {3.920040107685175*^9, 3.9200401135358047`*^9}, 
   3.92108069603515*^9, 3.921081491823523*^9, {3.921081642579871*^9, 
   3.921081643778735*^9}, {3.92112762759641*^9, 3.921127646546486*^9}, {
   3.921167375848999*^9, 3.921167388895515*^9}, {3.921167432908882*^9, 
   3.92116749476964*^9}, {3.921167698737151*^9, 3.921167710134108*^9}, {
   3.921168019515913*^9, 3.9211680223489237`*^9}, {3.92173269937141*^9, 
   3.92173270066335*^9}, 3.9230187705197678`*^9, {3.943422610280713*^9, 
   3.9434227018191347`*^9}},ExpressionUUID->"16377b35-33ba-4800-859b-\
956ead1199a8"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{
  3.921134423543795*^9, 3.921142854672223*^9, 3.92114571015902*^9, 
   3.9211666068023863`*^9, 3.921166752468234*^9, 3.9211668228690977`*^9, 
   3.9211673070354633`*^9, 3.9211673896188993`*^9, 3.921167496584173*^9, 
   3.9211677106747007`*^9, 3.921167917426516*^9, 3.921168023069647*^9, 
   3.9211730461820087`*^9, 3.92117311439108*^9, 3.921174169739768*^9, 
   3.92117426108948*^9, 3.921174366121439*^9, 3.921174428865559*^9, 
   3.9212069189017477`*^9, 3.921216606896443*^9, 3.921216668232225*^9, 
   3.9212168405959187`*^9, 3.921219695604409*^9, 3.921290228782696*^9, 
   3.9212903814355288`*^9, 3.921291923895403*^9, 3.921292554179283*^9, 
   3.921643395955228*^9, 3.921723320733714*^9, 3.921723372226862*^9, 
   3.9217325824606237`*^9, 3.921732701683489*^9, 3.921733649397765*^9, 
   3.921749974755869*^9, 3.9217515886383667`*^9, 3.921752273303174*^9, 
   3.9223643677734013`*^9, {3.92301876867675*^9, 3.923018772313154*^9}, 
   3.934341844941928*^9, 3.943422678981061*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"71b7b544-c916-41a1-8b5a-c1a9473bfffb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7303992564616948`"}], ",", 
   RowBox[{"-", "1.3215011855396135`"}], ",", "1.5462469942213826`", ",", 
   RowBox[{"-", "1.6870117130408335`"}], ",", 
   RowBox[{"-", "0.8930100645178047`"}], ",", "2.5458573781322436`", ",", 
   RowBox[{"-", "2.3544910252388753`"}], ",", "2.550671021877477`", ",", 
   "2.279391336408384`", ",", "2.615743804552192`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.921134423543795*^9, 3.921142854672223*^9, 3.92114571015902*^9, 
   3.9211666068023863`*^9, 3.921166752468234*^9, 3.9211668228690977`*^9, 
   3.9211673070354633`*^9, 3.9211673896188993`*^9, 3.921167496584173*^9, 
   3.9211677106747007`*^9, 3.921167917426516*^9, 3.921168023069647*^9, 
   3.9211730461820087`*^9, 3.92117311439108*^9, 3.921174169739768*^9, 
   3.92117426108948*^9, 3.921174366121439*^9, 3.921174428865559*^9, 
   3.9212069189017477`*^9, 3.921216606896443*^9, 3.921216668232225*^9, 
   3.9212168405959187`*^9, 3.921219695604409*^9, 3.921290228782696*^9, 
   3.9212903814355288`*^9, 3.921291923895403*^9, 3.921292554179283*^9, 
   3.921643395955228*^9, 3.921723320733714*^9, 3.921723372226862*^9, 
   3.9217325824606237`*^9, 3.921732701683489*^9, 3.921733649397765*^9, 
   3.921749974755869*^9, 3.9217515886383667`*^9, 3.921752273303174*^9, 
   3.9223643677734013`*^9, {3.92301876867675*^9, 3.923018772313154*^9}, 
   3.934341844941928*^9, 3.943422678982872*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"69e895b5-a397-49cb-b41e-1c947126ef68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tt", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nparameters"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nparameters"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0.02", ",", "0.1"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tt", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "aux"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tt", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "aux"}]}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nparameters"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "i", ",", "nparameters"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tt", "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minKL", "[", 
   RowBox[{"des_", ",", "G_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CapitalSigma]t", ",", "\[CapitalSigma]tinv", ",", 
      RowBox[{"Gt", "=", 
       RowBox[{"Gt", "[", "des", "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalSigma]t", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "m", "]"}], "+", 
        RowBox[{"Gt", ".", "Tt", ".", 
         RowBox[{"Transpose", "[", "Gt", "]"}]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalSigma]tinv", "=", 
      RowBox[{"Inverse", "[", "\[CapitalSigma]t", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "\[Sigma]2"}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Gt", ".", "at"}], "]"}], ".", "\[CapitalSigma]tinv", ".", 
         "Gt", ".", "at"}], "-", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Gt", ".", "at"}], "]"}], ".", "\[CapitalSigma]tinv", ".", 
         "G", ".", 
         RowBox[{"PseudoInverse", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "G", "]"}], ".", "\[CapitalSigma]tinv", 
           ".", "G"}], "]"}], ".", 
         RowBox[{"Transpose", "[", "G", "]"}], ".", "\[CapitalSigma]tinv", 
         ".", "Gt", ".", "at"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.921081403181882*^9, 3.921081416583774*^9}, {
   3.921081495101534*^9, 3.9210814952192287`*^9}, 3.921081649482861*^9, {
   3.92108205936631*^9, 3.921082060060747*^9}, {3.921129359492811*^9, 
   3.9211293619175863`*^9}, {3.921167794694398*^9, 3.921167794872463*^9}, {
   3.921168015191684*^9, 3.921168026395113*^9}, 3.9211731113580847`*^9, {
   3.921173988331243*^9, 3.921173988482959*^9}, {3.921174269141513*^9, 
   3.921174269523985*^9}, {3.9212168566571503`*^9, 3.921216856756233*^9}, {
   3.921732484998975*^9, 3.921732485027896*^9}, {3.921732524476186*^9, 
   3.921732532400283*^9}, {3.921732612015732*^9, 3.921732663360283*^9}, {
   3.9217327897100973`*^9, 3.921732791539585*^9}, {3.9217332176153393`*^9, 
   3.921733221600383*^9}, 3.92175047615904*^9, {3.921750595810466*^9, 
   3.921750596509115*^9}, {3.921750679769947*^9, 3.9217506880687532`*^9}, {
   3.9217509889111233`*^9, 3.921750991569512*^9}, {3.943422687019706*^9, 
   3.94342269384418*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"87d70e1a-8384-4ed7-ae50-63750b831936"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.07777918472851547`", "0.028755891266268388`", "0.05765621779065551`",
       "0.0628465460308741`", "0.06665421181648698`", "0.04351539379906938`", 
      "0.03321235643912332`", "0.0681006246370082`", "0.0803374060604321`", 
      "0.08168985625965641`"},
     {"0.028755891266268388`", "0.08228592685981231`", 
      "0.021888830858867267`", "0.09382052902489774`", "0.09939631529812176`",
       "0.04803270154534131`", "0.023600377213075327`", 
      "0.060108748422129016`", "0.0707004899892226`", 
      "0.07137663249994947`"},
     {"0.05765621779065551`", "0.021888830858867267`", 
      "0.051190017292446266`", "0.07319770200316436`", "0.08751052485247193`",
       "0.06552318494802087`", "0.05185698524043961`", "0.03909212076320975`",
       "0.07388102670459615`", "0.053560592716061395`"},
     {"0.0628465460308741`", "0.09382052902489774`", "0.07319770200316436`", 
      "0.06699182271038281`", "0.020666818694827782`", "0.09539526241746957`",
       "0.08170100234009173`", "0.0318002147634253`", "0.09718192724886415`", 
      "0.09189974189308062`"},
     {"0.06665421181648698`", "0.09939631529812176`", "0.08751052485247193`", 
      "0.020666818694827782`", "0.046637005678770924`", 
      "0.036363863327774415`", "0.08712282136898938`", "0.04003103949846612`",
       "0.03909104778266541`", "0.06932928281630557`"},
     {"0.04351539379906938`", "0.04803270154534131`", "0.06552318494802087`", 
      "0.09539526241746957`", "0.036363863327774415`", "0.090344247679019`", 
      "0.05236034212107671`", "0.05220136100894941`", "0.06129532713540681`", 
      "0.043360726404283664`"},
     {"0.03321235643912332`", "0.023600377213075327`", "0.05185698524043961`",
       "0.08170100234009173`", "0.08712282136898938`", "0.05236034212107671`",
       "0.047936186818242216`", "0.03484444127605006`", 
      "0.06825740495988772`", "0.022719708928131674`"},
     {"0.0681006246370082`", "0.060108748422129016`", "0.03909212076320975`", 
      "0.0318002147634253`", "0.04003103949846612`", "0.05220136100894941`", 
      "0.03484444127605006`", "0.08181260149174482`", "0.07137476920290403`", 
      "0.0852038317199362`"},
     {"0.0803374060604321`", "0.0707004899892226`", "0.07388102670459615`", 
      "0.09718192724886415`", "0.03909104778266541`", "0.06129532713540681`", 
      "0.06825740495988772`", "0.07137476920290403`", "0.05791518141321081`", 
      "0.05621528220858771`"},
     {"0.08168985625965641`", "0.07137663249994947`", "0.053560592716061395`",
       "0.09189974189308062`", "0.06932928281630557`", 
      "0.043360726404283664`", "0.022719708928131674`", "0.0852038317199362`",
       "0.05621528220858771`", "0.042658082387007246`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9210814068009357`*^9, 3.9210814400438557`*^9}, 
   3.9210814955933323`*^9, 3.921081651202416*^9, 3.921081845213868*^9, 
   3.921082062226468*^9, 3.9211276507963247`*^9, 3.921129363453944*^9, 
   3.921129867060504*^9, 3.92113353439602*^9, 3.921133847632777*^9, 
   3.921134428933029*^9, 3.921142974201363*^9, 3.921145711555896*^9, 
   3.921166608812004*^9, 3.921166761664403*^9, 3.921166837048848*^9, 
   3.921167308794654*^9, 3.92116771349575*^9, 3.9211677990949163`*^9, 
   3.921167919703871*^9, 3.921168026729497*^9, 3.921173050004137*^9, 
   3.9211731181677103`*^9, 3.921173989110697*^9, 3.921174178652507*^9, {
   3.92117426296034*^9, 3.9211742701704407`*^9}, 3.9211743680244093`*^9, 
   3.921174430815096*^9, 3.92120692199264*^9, 3.9212166089720707`*^9, 
   3.9212166706688147`*^9, {3.9212168423799877`*^9, 3.9212168572612543`*^9}, 
   3.921219697512487*^9, 3.921290230545483*^9, 3.921290384125915*^9, 
   3.921291925732126*^9, 3.921292555786006*^9, 3.921643398956643*^9, 
   3.921723323211025*^9, 3.921723373518436*^9, 3.92173248669459*^9, 
   3.921732532858021*^9, {3.921732584230835*^9, 3.921732663882069*^9}, 
   3.921732703157243*^9, 3.921732792210803*^9, 3.9217332236805143`*^9, 
   3.921733650912546*^9, 3.921749976923862*^9, 3.921750539552515*^9, 
   3.921750597971302*^9, 3.921750689262658*^9, 3.9217509935385303`*^9, 
   3.92175159103897*^9, 3.921752274870886*^9, 3.9223643694938374`*^9, 
   3.9230279364932337`*^9, 3.93434184693674*^9, 3.943422717420561*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"8f504ef3-e010-4183-ad47-\
22c7fce7674a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.920039878912929*^9, 3.920039879602158*^9}, {
   3.9200402181948843`*^9, 3.920040416546606*^9}, 3.9200404492487507`*^9, {
   3.9210445253633957`*^9, 3.921044540733897*^9}, {3.921074376371773*^9, 
   3.921074379828047*^9}, {3.921129318972587*^9, 3.921129319342491*^9}, {
   3.921129397446497*^9, 3.921129463205255*^9}, {3.921129746209038*^9, 
   3.9211297545689173`*^9}, {3.921129818432885*^9, 3.921129822833535*^9}, 
   3.92113009268608*^9, {3.9211691658377657`*^9, 3.921169167810568*^9}, 
   3.921174267678496*^9},ExpressionUUID->"b659e1dc-b2ff-44ff-b5c6-\
8f8e8e6b495f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rounding Approximate design", "Subtitle",
 CellChangeTimes->{{3.921126030722928*^9, 
  3.921126035742528*^9}},ExpressionUUID->"4ea32589-fed1-467d-a85c-\
b761f1eafc98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ceros", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "\[Chi]", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"ceros", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
        "\[IndentingNewLine]", "ceros"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<Out of bounds\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Variations", "[", "desexact_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"dif", "=", 
        RowBox[{"m", "-", 
         RowBox[{"sumlist", "[", "desexact", "]"}]}]}], ",", "negative", ",", 
       
       RowBox[{"listfinal", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dif", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", "desexact"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Abs", "[", "dif", "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"list", ",", 
            RowBox[{"desexact", "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "i", "]"}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Abs", "[", "dif", "]"}], "\[Equal]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"list", ",", 
            RowBox[{"desexact", "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "i", "]"}]}], "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "j", "]"}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Abs", "[", "dif", "]"}], "\[Equal]", "3"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"list", ",", 
            RowBox[{"desexact", "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "i", "]"}]}], "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "j", "]"}]}], "+", 
             RowBox[{
              RowBox[{"dif", "/", 
               RowBox[{"Abs", "[", "dif", "]"}]}], "*", 
              RowBox[{"e", "[", "k", "]"}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Abs", "[", "dif", "]"}], "\[GreaterEqual]", "4"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", 
          RowBox[{"desexact", "+", 
           RowBox[{"dif", "*", 
            RowBox[{"e", "[", "1", "]"}]}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "negative", " ", "numbers"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"negative", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "0"}], ",", 
             RowBox[{"negative", "=", "True"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"negative", "\[Equal]", "False"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"listfinal", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "listfinal"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxToExact1", "[", "\[Xi]approx_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Xi]exact", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"m", "*", "\[Xi]approx"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "variations", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"minKLvalues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variations", "=", 
       RowBox[{"Variations", "[", "\[Xi]exact", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"minKLvalues", ",", "\[IndentingNewLine]", 
          RowBox[{"minKL", "[", 
           RowBox[{
            RowBox[{"Design", "[", 
             RowBox[{"variations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"G1", "[", 
             RowBox[{"Design", "[", 
              RowBox[{"variations", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "variations", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]exact", "=", 
       RowBox[{"variations", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"minKLvalues", ",", 
            RowBox[{"Max", "[", "minKLvalues", "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxToExact2", "[", "\[Xi]approx_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Xi]exact", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"m", "*", "\[Xi]approx"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "variations", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"minKLvalues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variations", "=", 
       RowBox[{"Variations", "[", "\[Xi]exact", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"minKLvalues", ",", "\[IndentingNewLine]", 
          RowBox[{"minKL", "[", 
           RowBox[{
            RowBox[{"Design", "[", 
             RowBox[{"variations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"G2", "[", 
             RowBox[{"Design", "[", 
              RowBox[{"variations", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "variations", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]exact", "=", 
       RowBox[{"variations", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"minKLvalues", ",", 
            RowBox[{"Max", "[", "minKLvalues", "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxToExact3", "[", "\[Xi]approx_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Xi]exact", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"m", "*", "\[Xi]approx"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "variations", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"minKLvalues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variations", "=", 
       RowBox[{"Variations", "[", "\[Xi]exact", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"minKLvalues", ",", "\[IndentingNewLine]", 
          RowBox[{"minKL", "[", 
           RowBox[{
            RowBox[{"Design", "[", 
             RowBox[{"variations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"G3", "[", 
             RowBox[{"Design", "[", 
              RowBox[{"variations", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "variations", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]exact", "=", 
       RowBox[{"variations", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"minKLvalues", ",", 
            RowBox[{"Max", "[", "minKLvalues", "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxToExact4", "[", "\[Xi]approx_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Xi]exact", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"m", "*", "\[Xi]approx"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "variations", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"minKLvalues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"variations", "=", 
       RowBox[{"Variations", "[", "\[Xi]exact", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"minKLvalues", ",", "\[IndentingNewLine]", 
          RowBox[{"minKL", "[", 
           RowBox[{
            RowBox[{"Design", "[", 
             RowBox[{"variations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"G4", "[", 
             RowBox[{"Design", "[", 
              RowBox[{"variations", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "variations", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]exact", "=", 
       RowBox[{"variations", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"minKLvalues", ",", 
            RowBox[{"Max", "[", "minKLvalues", "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.921126058274592*^9, 3.92112607482236*^9}, {
   3.921126162920087*^9, 3.921126203941346*^9}, {3.921126260889312*^9, 
   3.921126263743297*^9}, {3.921126631009961*^9, 3.921126644479022*^9}, {
   3.921126676885125*^9, 3.92112667867245*^9}, 3.921127716980646*^9, {
   3.921129605072578*^9, 3.921129606155572*^9}, {3.921130177030352*^9, 
   3.921130183537958*^9}, {3.921130239078988*^9, 3.921130240512163*^9}, {
   3.921133548088484*^9, 3.921133559551248*^9}, {3.921133960095536*^9, 
   3.921133972880106*^9}, {3.921134171796472*^9, 3.921134179262656*^9}, {
   3.921134385846231*^9, 3.921134387034185*^9}, {3.9211344401967077`*^9, 
   3.921134450719043*^9}, {3.921135410644498*^9, 3.921135423194292*^9}, {
   3.921142999426437*^9, 3.921143013231433*^9}, {3.9211430514568787`*^9, 
   3.9211430972242517`*^9}, 3.92114356827759*^9, {3.921143648134467*^9, 
   3.921143650891304*^9}, {3.921143700280821*^9, 3.92114371368342*^9}, {
   3.9211437963839912`*^9, 3.921143797285059*^9}, {3.9211448648138227`*^9, 
   3.921144920998303*^9}, 3.921144969846163*^9, {3.921145187593688*^9, 
   3.921145197218145*^9}, {3.921145307495924*^9, 3.9211453309460917`*^9}, {
   3.9211672096733303`*^9, 3.921167211869191*^9}, {3.921167722742846*^9, 
   3.92116772440475*^9}, {3.9211682310012293`*^9, 3.921168246640918*^9}, {
   3.9211682941474533`*^9, 3.921168346256755*^9}, 3.921172455458766*^9, {
   3.921173254150239*^9, 3.921173350401328*^9}, {3.9211733987883263`*^9, 
   3.921173567337867*^9}, {3.921174037715716*^9, 3.921174072627776*^9}, {
   3.921174433075075*^9, 3.921174433542652*^9}, {3.9211746993785763`*^9, 
   3.921174707106167*^9}, {3.921219775326665*^9, 3.921219781109736*^9}, {
   3.921292518926816*^9, 3.921292524290934*^9}, 3.9213042528791103`*^9, {
   3.921304546472348*^9, 3.921304555751176*^9}, {3.9213045858877573`*^9, 
   3.921304587772543*^9}, {3.9216434893766117`*^9, 3.9216434987680693`*^9}, {
   3.921733466848093*^9, 3.921733472823827*^9}, {3.9217336831188707`*^9, 
   3.921733715479567*^9}, {3.921749982903916*^9, 3.9217499836723223`*^9}, {
   3.943422724375194*^9, 3.943422758897149*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"81222a0a-626e-4fcf-92c4-95ff1d695e68"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing KL-optimal designs", "Subtitle",
 CellChangeTimes->{{3.9200408090688143`*^9, 3.920040818466407*^9}, {
  3.943422780404447*^9, 
  3.9434227855615377`*^9}},ExpressionUUID->"bfadcb43-6c82-4135-9a72-\
b61533766f00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NN", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.921044632781288*^9, 3.921044637207436*^9}, {
   3.921044836105331*^9, 3.9210448586771193`*^9}, {3.921044894699123*^9, 
   3.921044901150641*^9}, {3.921045043586172*^9, 3.921045101351653*^9}, {
   3.9210451536175003`*^9, 3.921045183467319*^9}, 3.9210452189911118`*^9, 
   3.921046132053813*^9, {3.921046390993616*^9, 3.921046398714189*^9}, {
   3.921047018917598*^9, 3.921047019044633*^9}, {3.921047144811191*^9, 
   3.921047147923995*^9}, 3.921047190882166*^9, 3.921047345226953*^9, {
   3.921047674504298*^9, 3.921047674710392*^9}, 3.921047764917368*^9, 
   3.921048053943664*^9, {3.9210481443041267`*^9, 3.921048145002618*^9}, 
   3.921072208657989*^9, 3.921072767327948*^9, 3.921072814401745*^9, {
   3.921072902010449*^9, 3.921072903565393*^9}, {3.921074586328313*^9, 
   3.9210746166061573`*^9}, 3.9211337128773127`*^9, 3.921135141271263*^9, 
   3.92113523589856*^9, {3.921143263222645*^9, 3.921143276806912*^9}, {
   3.921145654359095*^9, 3.921145654754915*^9}, {3.9211457190662603`*^9, 
   3.921145719684897*^9}, 3.921174016192659*^9, 3.921174566580515*^9, {
   3.921216680902822*^9, 3.9212166812890577`*^9}, {3.9212168645988693`*^9, 
   3.92121686466593*^9}, {3.921219469753435*^9, 3.921219469862496*^9}, {
   3.921252890784292*^9, 3.9212528980189*^9}, {3.921253935273*^9, 
   3.921253939341289*^9}, {3.9212905465562887`*^9, 3.921290546711652*^9}, {
   3.92129155426711*^9, 3.92129155465417*^9}, {3.9212919736797667`*^9, 
   3.921291974483552*^9}, {3.921293950661105*^9, 3.921293950928863*^9}, {
   3.9213040026903257`*^9, 3.92130400284665*^9}, {3.921724682038989*^9, 
   3.921724682103297*^9}, {3.921726221014915*^9, 3.921726221509922*^9}, {
   3.921731060281208*^9, 3.921731063226714*^9}, 3.921733369667556*^9, 
   3.921733838522544*^9, {3.921733965341647*^9, 3.921733971377573*^9}, 
   3.921734924005001*^9, 3.921749584828906*^9, {3.921749944042451*^9, 
   3.921749952606718*^9}, {3.921750275130279*^9, 3.921750276417788*^9}, {
   3.9217506960222387`*^9, 3.921750696605445*^9}, {3.934343725010285*^9, 
   3.934343726059939*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"846aafc1-15e9-4772-9cef-b468213399b7"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"1", " ", "vs", " ", "maximal"}], " ", "*)"}], "Subtitle"], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"STEP", " ", "1.1"}], ":", " ", 
    RowBox[{
    "GENERATE", " ", "INITIAL", " ", "PARTICLES", " ", "AND", " ", "THEIR", 
     " ", "VELOCITIES"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"designsX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"designsX", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"designsX", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "/", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"designsX", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VelocPARAM", " ", "=", " ", "0.3"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitiesX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "VelocPARAM"}], ",", "VelocPARAM"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"Velocities", " ", "vector"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"STEP", " ", "1.2"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Xi]exact", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ApproxToExact1", "[", 
        RowBox[{"designsX", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localvalues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minKL", "[", 
        RowBox[{
         RowBox[{"Design", "[", 
          RowBox[{"\[Xi]exact", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"G1", "[", 
          RowBox[{"Design", "[", 
           RowBox[{"\[Xi]exact", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localBESTvalues", "=", "localvalues"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"localvalues", " ", "are", " ", "the", " ", "best"}], ",", " ", 
     RowBox[{
     "because", " ", "it", " ", "is", " ", "the", " ", "first", " ", 
      "step"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Step", " ", "1.3", " ", "Best", " ", "local", " ", "and", " ", "best", 
     " ", "global", " ", "particles"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localbestX", "=", "designsX"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionMax", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"localBESTvalues", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"globalbestX", "=", 
     RowBox[{"localbestX", "[", 
      RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1X", "=", "1"}], ";", " ", 
    RowBox[{"c2X", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "1"}], ";", 
    RowBox[{"tmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niter", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Step", " ", "2.1", " ", "Computing", " ", "the", " ", "new", " ", 
         "velocities"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", ">=", " ", 
            RowBox[{"0.8", "*", "tmax"}]}], ",", " ", 
           RowBox[{"\[Omega]", "=", "0.2"}], ",", " ", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], ")"}], 
              "*", "t"}], "+", "0.95", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R1X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"R2X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"velocitiesX", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Omega]", "*", "velocitiesX"}], " ", "+", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"c1X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R1X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{"localbestX", "-", " ", "designsX"}], " ", "]"}]}], 
             "]"}]}], "+", "\[IndentingNewLine]", 
           RowBox[{"c2X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R2X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"globalbestX", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], " ", 
                "-", " ", "designsX"}], "]"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Step", " ", "2.2", " ", "Updating", " ", "the", " ", "particles"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"designsXprev", " ", "=", " ", "designsX"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"design", " ", "step", " ", "t"}], "-", "1"}], " ", "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"designsX", " ", "=", " ", 
          RowBox[{"designsXprev", " ", "+", " ", "velocitiesX"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{"Controlling", " ", "the", " ", "designs"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"suma", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"designsX", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"designsX", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"suma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[Xi]exact", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ApproxToExact1", "[", 
             RowBox[{"designsX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Step", " ", "2.3", " ", "Computing", " ", "the", " ", "criterion", 
           " ", "for", " ", "the", " ", "all", " ", "new", " ", "particles"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"localvalues", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"minKL", "[", 
             RowBox[{
              RowBox[{"Design", "[", 
               RowBox[{"\[Xi]exact", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"G1", "[", 
               RowBox[{"Design", "[", 
                RowBox[{"\[Xi]exact", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "We", " ", "have", " ", "to", " ", "change", " ", "Gi", " ", "for",
             " ", "each", " ", "KL"}], "-", 
           RowBox[{"optimal", " ", "design"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Step", " ", "2.4"}], ":", " ", 
           RowBox[{
           "Updating", " ", "the", " ", "best", " ", "local", " ", 
            "particle"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"localvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}], ">", " ", 
              RowBox[{"localBESTvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"localbestX", "[", 
                RowBox[{"[", "s", "]"}], "]"}], " ", "=", 
               RowBox[{"designsX", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"localBESTvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "=", 
               RowBox[{"localvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Step", " ", "2.5"}], ":", " ", 
           RowBox[{"updating", " ", "global", " ", "best"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"PositionMax", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"localBESTvalues", ",", " ", 
              RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], " ", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"globalbestX", "=", 
          RowBox[{"localbestX", "[", 
           RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "niter"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"globalbestX", "//", "MatrixForm"}], ",", 
        RowBox[{"\[Chi]", "//", "MatrixForm"}], ",", 
        RowBox[{
         RowBox[{"ApproxToExact1", "[", "globalbestX", "]"}], "//", 
         "MatrixForm"}], ",", "t", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", "localBESTvalues", "]"}], "-", 
         RowBox[{"Min", "[", "localBESTvalues", "]"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt1", "=", "globalbestX"}], "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Eff1opt", "=", 
    RowBox[{"Max", "[", "localBESTvalues", "]"}]}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.921173734013321*^9, 3.921173734622504*^9}, {
   3.921173922058691*^9, 3.921173931034726*^9}, 3.921174316102797*^9, {
   3.9211743954157047`*^9, 3.9211743975193357`*^9}, {3.9211746250738087`*^9, 
   3.92117464780202*^9}, {3.921209893453342*^9, 3.921209917957362*^9}, {
   3.921209977514072*^9, 3.921209978156684*^9}, 3.921214780819419*^9, {
   3.921216423639694*^9, 3.921216424945063*^9}, {3.921216545777079*^9, 
   3.921216547610042*^9}, {3.9212168684716063`*^9, 3.921216868568531*^9}, {
   3.921216970710814*^9, 3.921216997115148*^9}, {3.921218524503304*^9, 
   3.921218541734694*^9}, 3.921233225020775*^9, {3.9212345308030643`*^9, 
   3.9212345309796267`*^9}, {3.921253822782324*^9, 3.921253823188176*^9}, 
   3.921253948468934*^9, {3.92129163666885*^9, 3.921291637935916*^9}, {
   3.921291714634452*^9, 3.921291722469368*^9}, {3.921291995013566*^9, 
   3.92129199708932*^9}, {3.921292599756372*^9, 3.921292599844508*^9}, {
   3.9212939457481403`*^9, 3.9212939468912153`*^9}, 3.921297795502779*^9, 
   3.9213049406616163`*^9, {3.92164351275576*^9, 3.921643519336318*^9}, {
   3.921724825100731*^9, 3.921724826644188*^9}, {3.921725272268689*^9, 
   3.9217252723837023`*^9}, 3.921725605388344*^9, {3.921725858016436*^9, 
   3.921725858089121*^9}, {3.921726218368499*^9, 3.921726218830535*^9}, {
   3.921726973874445*^9, 3.92172698107729*^9}, {3.921729671925466*^9, 
   3.921729673370269*^9}, {3.921731042450329*^9, 3.921731052447888*^9}, {
   3.921732740967964*^9, 3.921732749888637*^9}, {3.921732837150565*^9, 
   3.921732838094318*^9}, {3.921733179083733*^9, 3.9217331791496162`*^9}, 
   3.921733261770838*^9, {3.921733366513218*^9, 3.921733375574171*^9}, {
   3.921733481164947*^9, 3.921733509206615*^9}, {3.921733955331821*^9, 
   3.921733958789714*^9}, {3.9217342909196377`*^9, 3.921734291712078*^9}, {
   3.921735235442927*^9, 3.921735246267071*^9}, {3.921735311814296*^9, 
   3.921735313252996*^9}, {3.93434187333432*^9, 3.9343418924427557`*^9}, {
   3.934341930502873*^9, 3.934341932524149*^9}, {3.934341972878006*^9, 
   3.934341994755549*^9}, {3.934343003354966*^9, 3.934343004037651*^9}, {
   3.943422791166267*^9, 3.943422900557879*^9}, {3.9434229994990473`*^9, 
   3.943423003955624*^9}},ExpressionUUID->"9b04790e-e563-4060-8aa5-\
b2e54e7f374f"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"2", " ", "vs", " ", "maximal"}], " ", "*)"}], "Subtitle"], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"STEP", " ", "1.1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"designsX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"designsX", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"designsX", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "/", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"designsX", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VelocPARAM", " ", "=", " ", "0.3"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitiesX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "VelocPARAM"}], ",", "VelocPARAM"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"STEP", " ", "1.2"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]exact", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ApproxToExact2", "[", 
        RowBox[{"designsX", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localvalues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minKL", "[", 
        RowBox[{
         RowBox[{"Design", "[", 
          RowBox[{"\[Xi]exact", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"G2", "[", 
          RowBox[{"Design", "[", 
           RowBox[{"\[Xi]exact", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localBESTvalues", "=", "localvalues"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Step", " ", "1.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localbestX", "=", "designsX"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionMax", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"localBESTvalues", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"globalbestX", "=", 
     RowBox[{"localbestX", "[", 
      RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1X", "=", "1"}], ";", " ", 
    RowBox[{"c2X", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "1"}], ";", 
    RowBox[{"tmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niter", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Step", " ", "2.1"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", ">=", " ", 
            RowBox[{"0.8", "*", "tmax"}]}], ",", " ", 
           RowBox[{"\[Omega]", "=", "0.2"}], ",", " ", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], ")"}], 
              "*", "t"}], "+", "0.95", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R1X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"R2X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"velocitiesX", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Omega]", "*", "velocitiesX"}], " ", "+", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"c1X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R1X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{"localbestX", "-", " ", "designsX"}], " ", "]"}]}], 
             "]"}]}], "+", "\[IndentingNewLine]", 
           RowBox[{"c2X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R2X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"globalbestX", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], " ", 
                "-", " ", "designsX"}], "]"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.2"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"designsXprev", " ", "=", " ", "designsX"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"designsX", " ", "=", " ", 
          RowBox[{"designsXprev", " ", "+", " ", "velocitiesX"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"suma", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"designsX", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"designsX", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"suma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[Xi]exact", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ApproxToExact2", "[", 
             RowBox[{"designsX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.3"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"localvalues", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"minKL", "[", 
             RowBox[{
              RowBox[{"Design", "[", 
               RowBox[{"\[Xi]exact", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"G2", "[", 
               RowBox[{"Design", "[", 
                RowBox[{"\[Xi]exact", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", "  ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.4"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"localvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}], ">", " ", 
              RowBox[{"localBESTvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"localbestX", "[", 
                RowBox[{"[", "s", "]"}], "]"}], " ", "=", 
               RowBox[{"designsX", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"localBESTvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "=", 
               RowBox[{"localvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.5"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"PositionMax", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"localBESTvalues", ",", " ", 
              RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], " ", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"globalbestX", "=", 
          RowBox[{"localbestX", "[", 
           RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "niter"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"globalbestX", "//", "MatrixForm"}], ",", 
        RowBox[{"\[Chi]", "//", "MatrixForm"}], ",", 
        RowBox[{
         RowBox[{"ApproxToExact2", "[", "globalbestX", "]"}], "//", 
         "MatrixForm"}], ",", "t", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", "localBESTvalues", "]"}], "-", 
         RowBox[{"Min", "[", "localBESTvalues", "]"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt2", "=", "globalbestX"}], "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Eff2opt", "=", 
    RowBox[{"Max", "[", "localBESTvalues", "]"}]}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.921219822604147*^9, 3.921219840919444*^9}, {
   3.9212536958039303`*^9, 3.921253718563249*^9}, {3.921643539339849*^9, 
   3.921643552970181*^9}, {3.921722765768887*^9, 3.921722767173408*^9}, 
   3.9217268906199913`*^9, {3.9217270498128433`*^9, 3.921727051985999*^9}, 
   3.921728033720675*^9, {3.921729611427185*^9, 3.9217296311473207`*^9}, {
   3.9217337280906563`*^9, 3.921733738005163*^9}, {3.9217341585270357`*^9, 
   3.921734168704248*^9}, {3.921735257790841*^9, 3.921735261197688*^9}, {
   3.921735348710677*^9, 3.9217353501940603`*^9}, {3.934342645971237*^9, 
   3.934342660709806*^9}, {3.934344173960685*^9, 3.9343441836596212`*^9}, {
   3.943422914156755*^9, 3.943422995072523*^9}, 
   3.943423027711256*^9},ExpressionUUID->"85aa714d-8589-4ed7-a357-\
8d2b84f06ef0"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"3", " ", "vs", " ", "maximal"}], " ", "*)"}], "Subtitle"], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"STEP", " ", "1.1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"designsX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"designsX", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"designsX", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "/", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"designsX", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VelocPARAM", " ", "=", " ", "0.3"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitiesX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "VelocPARAM"}], ",", "VelocPARAM"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"STEP", " ", "1.2"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]exact", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ApproxToExact3", "[", 
        RowBox[{"designsX", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localvalues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minKL", "[", 
        RowBox[{
         RowBox[{"Design", "[", 
          RowBox[{"\[Xi]exact", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"G3", "[", 
          RowBox[{"Design", "[", 
           RowBox[{"\[Xi]exact", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localBESTvalues", "=", "localvalues"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Step", " ", "1.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localbestX", "=", "designsX"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionMax", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"localBESTvalues", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"globalbestX", "=", 
     RowBox[{"localbestX", "[", 
      RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1X", "=", "1"}], ";", " ", 
    RowBox[{"c2X", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "1"}], ";", 
    RowBox[{"tmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niter", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Step", " ", "2.1"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", ">=", " ", 
            RowBox[{"0.8", "*", "tmax"}]}], ",", " ", 
           RowBox[{"\[Omega]", "=", "0.2"}], ",", " ", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], ")"}], 
              "*", "t"}], "+", "0.95", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R1X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"R2X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"velocitiesX", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Omega]", "*", "velocitiesX"}], " ", "+", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"c1X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R1X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{"localbestX", "-", " ", "designsX"}], " ", "]"}]}], 
             "]"}]}], "+", "\[IndentingNewLine]", 
           RowBox[{"c2X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R2X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"globalbestX", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], " ", 
                "-", " ", "designsX"}], "]"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.2"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"designsXprev", " ", "=", " ", "designsX"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"designsX", " ", "=", " ", 
          RowBox[{"designsXprev", " ", "+", " ", "velocitiesX"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"suma", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"designsX", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"designsX", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"suma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[Xi]exact", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ApproxToExact3", "[", 
             RowBox[{"designsX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.3"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"localvalues", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"minKL", "[", 
             RowBox[{
              RowBox[{"Design", "[", 
               RowBox[{"\[Xi]exact", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"G3", "[", 
               RowBox[{"Design", "[", 
                RowBox[{"\[Xi]exact", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", "   ",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Step", " ", "2.4"}], ":"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"localvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}], ">", " ", 
              RowBox[{"localBESTvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"localbestX", "[", 
                RowBox[{"[", "s", "]"}], "]"}], " ", "=", 
               RowBox[{"designsX", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"localBESTvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "=", 
               RowBox[{"localvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.5"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"PositionMax", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"localBESTvalues", ",", " ", 
              RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], " ", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"globalbestX", "=", 
          RowBox[{"localbestX", "[", 
           RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "niter"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"globalbestX", "//", "MatrixForm"}], ",", 
        RowBox[{"\[Chi]", "//", "MatrixForm"}], ",", 
        RowBox[{
         RowBox[{"ApproxToExact3", "[", "globalbestX", "]"}], "//", 
         "MatrixForm"}], ",", "t", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", "localBESTvalues", "]"}], "-", 
         RowBox[{"Min", "[", "localBESTvalues", "]"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt3", "=", "globalbestX"}], "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt3", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Eff3opt", "=", 
    RowBox[{"Max", "[", "localBESTvalues", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.9216434500538054`*^9, 3.921643476471025*^9}, {
   3.9216435613941708`*^9, 3.9216435809838247`*^9}, {3.921723178254787*^9, 
   3.921723178676354*^9}, {3.92172345647323*^9, 3.921723487405735*^9}, {
   3.921733747538096*^9, 3.921733753669228*^9}, {3.921734532826277*^9, 
   3.921734537486812*^9}, {3.9217346243288937`*^9, 3.9217346260610733`*^9}, 
   3.921734701214376*^9, {3.921735268802526*^9, 3.921735271935754*^9}, {
   3.921735360011724*^9, 3.921735361773732*^9}, {3.9343443474628553`*^9, 
   3.934344403502644*^9}, 3.9434229931102467`*^9, {3.943423032530354*^9, 
   3.943423089261355*^9}},ExpressionUUID->"1ebc1424-71cf-444c-8a16-\
103714f0528a"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"4", " ", "vs", " ", "maximal"}], " ", "*)"}], "Subtitle"], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"STEP", " ", "1.1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"designsX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"designsX", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"designsX", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "/", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"designsX", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VelocPARAM", " ", "=", " ", "0.3"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitiesX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "VelocPARAM"}], ",", "VelocPARAM"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"STEP", " ", "1.2"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Xi]exact", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ApproxToExact4", "[", 
        RowBox[{"designsX", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localvalues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minKL", "[", 
        RowBox[{
         RowBox[{"Design", "[", 
          RowBox[{"\[Xi]exact", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"G4", "[", 
          RowBox[{"Design", "[", 
           RowBox[{"\[Xi]exact", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localBESTvalues", "=", "localvalues"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Step", " ", "1.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localbestX", "=", "designsX"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionMax", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"localBESTvalues", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"globalbestX", "=", 
     RowBox[{"localbestX", "[", 
      RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1X", "=", "1"}], ";", " ", 
    RowBox[{"c2X", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "1"}], ";", 
    RowBox[{"tmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niter", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Step", " ", "2.1"}], "  ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", ">=", " ", 
            RowBox[{"0.8", "*", "tmax"}]}], ",", " ", 
           RowBox[{"\[Omega]", "=", "0.2"}], ",", " ", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], ")"}], 
              "*", "t"}], "+", "0.95", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R1X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"R2X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"velocitiesX", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Omega]", "*", "velocitiesX"}], " ", "+", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"c1X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R1X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{"localbestX", "-", " ", "designsX"}], " ", "]"}]}], 
             "]"}]}], "+", "\[IndentingNewLine]", 
           RowBox[{"c2X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R2X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"globalbestX", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], " ", 
                "-", " ", "designsX"}], "]"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.2"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"designsXprev", " ", "=", " ", "designsX"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"designsX", " ", "=", " ", 
          RowBox[{"designsXprev", " ", "+", " ", "velocitiesX"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"suma", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"designsX", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"designsX", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"suma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[Xi]exact", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ApproxToExact4", "[", 
             RowBox[{"designsX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"localvalues", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"minKL", "[", 
             RowBox[{
              RowBox[{"Design", "[", 
               RowBox[{"\[Xi]exact", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"G4", "[", 
               RowBox[{"Design", "[", 
                RowBox[{"\[Xi]exact", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", "   ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "We", " ", "have", " ", "to", " ", "change", " ", "Gi", " ", "for",
             " ", "each", " ", "KL"}], "-", 
           RowBox[{"optimal", " ", "design"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.4"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"localvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}], ">", " ", 
              RowBox[{"localBESTvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"localbestX", "[", 
                RowBox[{"[", "s", "]"}], "]"}], " ", "=", 
               RowBox[{"designsX", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"localBESTvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "=", 
               RowBox[{"localvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.5"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"PositionMax", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"localBESTvalues", ",", " ", 
              RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], " ", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"globalbestX", "=", 
          RowBox[{"localbestX", "[", 
           RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "niter"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"globalbestX", "//", "MatrixForm"}], ",", 
        RowBox[{"\[Chi]", "//", "MatrixForm"}], ",", 
        RowBox[{
         RowBox[{"ApproxToExact4", "[", "globalbestX", "]"}], "//", 
         "MatrixForm"}], ",", "t", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", "localBESTvalues", "]"}], "-", 
         RowBox[{"Min", "[", "localBESTvalues", "]"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt4", "=", "globalbestX"}], "\[IndentingNewLine]", 
   RowBox[{"\[Xi]opt4", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Eff4opt", "=", 
    RowBox[{"Max", "[", "localBESTvalues", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.9216435825200233`*^9, 3.921643595181458*^9}, {
   3.921723537651585*^9, 3.921723558722665*^9}, {3.92173376045471*^9, 
   3.921733767832692*^9}, {3.921734635537685*^9, 3.9217346432050457`*^9}, 
   3.921734895486905*^9, {3.921735280213525*^9, 3.921735284216681*^9}, {
   3.921735373729371*^9, 3.92173537516157*^9}, {3.934345777462887*^9, 
   3.934345788555149*^9}, {3.934345882246748*^9, 3.934345886627797*^9}, {
   3.9434230956186447`*^9, 
   3.943423154523491*^9}},ExpressionUUID->"23359157-7356-4920-a358-\
987867b87bc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Max-min KL-efficiency\
\>", "Subtitle",
 CellChangeTimes->{{3.9217531048715677`*^9, 
  3.921753126563064*^9}},ExpressionUUID->"2e0d64eb-fea2-4a48-99de-\
b750532e8f49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eff1", "[", "des_", "]"}], ":=", 
  RowBox[{
   RowBox[{"minKL", "[", 
    RowBox[{
     RowBox[{"Design", "[", 
      RowBox[{"ApproxToExact1", "[", "des", "]"}], "]"}], ",", 
     RowBox[{"G1", "[", 
      RowBox[{"Design", "[", 
       RowBox[{"ApproxToExact1", "[", "des", "]"}], "]"}], "]"}]}], "]"}], 
   "/", "Eff1opt"}]}], "\n", 
 RowBox[{
  RowBox[{"Eff2", "[", "des_", "]"}], ":=", 
  RowBox[{
   RowBox[{"minKL", "[", 
    RowBox[{
     RowBox[{"Design", "[", 
      RowBox[{"ApproxToExact2", "[", "des", "]"}], "]"}], ",", 
     RowBox[{"G2", "[", 
      RowBox[{"Design", "[", 
       RowBox[{"ApproxToExact2", "[", "des", "]"}], "]"}], "]"}]}], "]"}], 
   "/", "Eff2opt"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eff3", "[", "des_", "]"}], ":=", 
  RowBox[{
   RowBox[{"minKL", "[", 
    RowBox[{
     RowBox[{"Design", "[", 
      RowBox[{"ApproxToExact3", "[", "des", "]"}], "]"}], ",", 
     RowBox[{"G3", "[", 
      RowBox[{"Design", "[", 
       RowBox[{"ApproxToExact3", "[", "des", "]"}], "]"}], "]"}]}], "]"}], 
   "/", "Eff3opt"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eff4", "[", "des_", "]"}], ":=", 
  RowBox[{
   RowBox[{"minKL", "[", 
    RowBox[{
     RowBox[{"Design", "[", 
      RowBox[{"ApproxToExact4", "[", "des", "]"}], "]"}], ",", 
     RowBox[{"G4", "[", 
      RowBox[{"Design", "[", 
       RowBox[{"ApproxToExact4", "[", "des", "]"}], "]"}], "]"}]}], "]"}], 
   "/", "Eff4opt"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minEff", "[", "des_", "]"}], ":=", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"Eff1", "[", "des", "]"}], ",", 
    RowBox[{"Eff2", "[", "des", "]"}], ",", 
    RowBox[{"Eff3", "[", "des", "]"}], ",", 
    RowBox[{"Eff4", "[", "des", "]"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.9217531281940317`*^9, 3.921753150887968*^9}, {
  3.921753196789136*^9, 3.9217531994667683`*^9}, {3.9217532317638817`*^9, 
  3.9217533119403963`*^9}, {3.922364764888835*^9, 3.922364804372237*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"951a1a2d-af81-4126-ad27-89c97b038762"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["PSO for MaxMin KL-efficiency criterion", \
"Subtitle"]], "Title",
 CellChangeTimes->{{3.921809515954289*^9, 3.92180952829471*^9}, {
  3.921897044423933*^9, 
  3.921897046878669*^9}},ExpressionUUID->"e4587a58-bb56-42a6-a494-\
50572f2c7310"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NN", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.921810243933168*^9, 3.921810252273839*^9}, {
  3.921814950894487*^9, 3.9218149514096117`*^9}, {3.9343459133528957`*^9, 
  3.934345931844776*^9}, {3.9343464715037622`*^9, 3.934346477240075*^9}, {
  3.934347941502009*^9, 3.934347941784733*^9}, {3.934348187598454*^9, 
  3.93434818855798*^9}},ExpressionUUID->"d00fca7b-5c4e-47eb-bc3a-\
eb8be958dc1a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"STEP", " ", "1.1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"designsX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"designsX", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"designsX", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "/", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"designsX", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VelocPARAM", " ", "=", " ", "0.5"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitiesX", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"Real", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "VelocPARAM"}], ",", "VelocPARAM"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "NN"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"STEP", " ", "1.2"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localvalues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minEff", "[", 
        RowBox[{"designsX", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localBESTvalues", "=", "localvalues"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Step", " ", "1.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localbestX", "=", "designsX"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PositionMax", "=", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"localBESTvalues", ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"globalbestX", "=", 
     RowBox[{"localbestX", "[", 
      RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1X", "=", "1.5"}], ";", " ", 
    RowBox[{"c2X", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "1"}], ";", 
    RowBox[{"tmax", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niter", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Step", " ", "2.1"}], "  ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", ">=", " ", 
            RowBox[{"0.8", "*", "tmax"}]}], ",", " ", 
           RowBox[{"\[Omega]", "=", "0.2"}], ",", " ", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], ")"}], 
              "*", "t"}], "+", "0.95", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.2", "-", "0.95"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"0.8", "*", "tmax"}], "-", "1"}], ")"}]}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"R1X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"R2X", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Random", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"velocitiesX", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Omega]", "*", "velocitiesX"}], " ", "+", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"c1X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R1X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{"localbestX", "-", " ", "designsX"}], " ", "]"}]}], 
             "]"}]}], "+", "\[IndentingNewLine]", 
           RowBox[{"c2X", " ", "*", 
            RowBox[{"Transpose", "[", 
             RowBox[{"R2X", " ", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"globalbestX", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], " ", 
                "-", " ", "designsX"}], "]"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.2"}], "  ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"designsXprev", " ", "=", " ", "designsX"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"designsX", " ", "=", " ", 
          RowBox[{"designsXprev", " ", "+", " ", "velocitiesX"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "<", "0"}], ",", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"suma", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"designsX", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"designsX", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"designsX", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"suma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[Chi]", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.3"}], "  ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"localvalues", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"minEff", "[", 
             RowBox[{"designsX", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}]}], ";", "   ",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.4"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"localvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}], ">", " ", 
              RowBox[{"localBESTvalues", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"localbestX", "[", 
                RowBox[{"[", "s", "]"}], "]"}], " ", "=", 
               RowBox[{"designsX", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"localBESTvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "=", 
               RowBox[{"localvalues", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Step", " ", "2.5"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"PositionMax", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"localBESTvalues", ",", " ", 
              RowBox[{"Max", "[", "localBESTvalues", "]"}]}], "]"}], " ", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"globalbestX", "=", 
          RowBox[{"localbestX", "[", 
           RowBox[{"[", "PositionMax", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "niter"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"globalbestX", "//", "MatrixForm"}], ",", 
        RowBox[{"\[Chi]", "//", "MatrixForm"}], ",", "t", ",", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"m", "*", "globalbestX"}], "]"}], "//", "MatrixForm"}], ",", 
        RowBox[{"Max", "[", "localBESTvalues", "]"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", "localBESTvalues", "]"}], "-", 
         RowBox[{"Min", "[", "localBESTvalues", "]"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"globalbestX", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"\[Xi]minmaxEffopt", "=", 
    RowBox[{"Max", "[", "localBESTvalues", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.9218095504178257`*^9, 3.9218095735733557`*^9}, {
   3.92180961063776*^9, 3.921809649164648*^9}, {3.9218102721865187`*^9, 
   3.921810283332025*^9}, {3.921814843943919*^9, 3.921814844117138*^9}, 
   3.9218943454746637`*^9, {3.934345921360251*^9, 3.934345922056481*^9}, {
   3.934346472863331*^9, 3.934346499914802*^9}, {3.934348191602096*^9, 
   3.9343481988920603`*^9}, {3.9434231911247587`*^9, 
   3.943423242053104*^9}},ExpressionUUID->"6718ac3f-ef1e-4bca-a5fc-\
cb52ec2374a4"],

Cell[CellGroupData[{

Cell["Approximation of maxmin KL-eff design", "Subtitle",
 CellChangeTimes->{{3.943423268937892*^9, 
  3.943423275747538*^9}},ExpressionUUID->"1e491bf1-6ec9-4f9d-bf89-\
d3a1718ff6ae"],

Cell[BoxData[{
 RowBox[{"\[Xi]minmaxEffopt", "=", 
  RowBox[{"Round", "[", 
   RowBox[{"m", "*", "\[Xi]minmaxEffopt"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"variations", "=", 
    RowBox[{"Variations", "[", "\[Xi]minmaxEffopt", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listaux", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"listaux", ",", "\[IndentingNewLine]", 
     RowBox[{"Min", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"minKL", "[", 
         RowBox[{
          RowBox[{"Design", "[", 
           RowBox[{"variations", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"G1", "[", 
           RowBox[{"Design", "[", 
            RowBox[{"variations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], "/", 
        "Eff1opt"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"minKL", "[", 
         RowBox[{
          RowBox[{"Design", "[", 
           RowBox[{"variations", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"G2", "[", 
           RowBox[{"Design", "[", 
            RowBox[{"variations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], "/", 
        "Eff2opt"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"minKL", "[", 
         RowBox[{
          RowBox[{"Design", "[", 
           RowBox[{"variations", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"G3", "[", 
           RowBox[{"Design", "[", 
            RowBox[{"variations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], "/", 
        "Eff3opt"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"minKL", "[", 
         RowBox[{
          RowBox[{"Design", "[", 
           RowBox[{"variations", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"G4", "[", 
           RowBox[{"Design", "[", 
            RowBox[{"variations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], "/", 
        "Eff4opt"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "variations", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"listaux", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Xi]minmaxEffopt", "=", 
  RowBox[{"variations", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"listaux", ",", 
       RowBox[{"Max", "[", "listaux", "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Xi]minmaxEffoptvalue", "=", 
  RowBox[{"listaux", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"listaux", ",", 
       RowBox[{"Max", "[", "listaux", "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.922364599084126*^9, 3.922364652007628*^9}, {
   3.922364704573903*^9, 3.922364714297082*^9}, {3.922365593391048*^9, 
   3.922365601327178*^9}, {3.9223663301933317`*^9, 3.922366366778358*^9}, 
   3.923028006854775*^9, {3.943423306010296*^9, 
   3.943423358380818*^9}},ExpressionUUID->"c6783c56-5960-4068-82cf-\
14d2805661be"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 927},
WindowMargins->{{7, Automatic}, {Automatic, -172}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.2 para Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b9a160f1-cdfb-4228-a0f9-323c937a161c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 164, 2, 44, "Input",ExpressionUUID->"981b4710-4d3e-4d7a-a8a9-40d82f65511c"],
Cell[CellGroupData[{
Cell[747, 26, 263, 4, 79, "Subtitle",ExpressionUUID->"a006670b-50a0-4485-aec8-b73945db9145"],
Cell[1013, 32, 3860, 67, 310, "Input",ExpressionUUID->"01a24b02-385b-40ba-9a21-e75c7bbe83ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4910, 104, 219, 3, 79, "Subtitle",ExpressionUUID->"18a553a4-de38-49f8-93f4-74d9d1865a33"],
Cell[5132, 109, 4699, 115, 1338, "Input",ExpressionUUID->"7b962d35-3595-42eb-ba4e-5866bd87e3c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9868, 229, 345, 5, 79, "Subtitle",ExpressionUUID->"08eb0796-0485-4f73-8a42-fb3ec2ee632a"],
Cell[10216, 236, 2249, 47, 302, "Input",ExpressionUUID->"505490e2-fb3d-4e75-b809-6510454e9534"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12502, 288, 320, 5, 79, "Subtitle",ExpressionUUID->"d017942a-430a-4265-9709-de66648d0738"],
Cell[12825, 295, 478, 11, 46, "Input",ExpressionUUID->"0a520ba8-eb2e-46eb-b816-b87ed2051195"],
Cell[13306, 308, 2457, 59, 441, "Input",ExpressionUUID->"824f3c61-1ed9-4c80-bb15-ed1f15e867d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15800, 372, 272, 4, 79, "Subtitle",ExpressionUUID->"079fbfe8-9e5d-47a8-b916-8fa30e42cd10"],
Cell[16075, 378, 2269, 56, 441, "Input",ExpressionUUID->"40f40e56-af8e-49b2-8bc8-83d7035300af"],
Cell[18347, 436, 175, 3, 46, "Input",ExpressionUUID->"58675416-8a7f-40ce-96fc-0ceb0d04f51a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18559, 444, 278, 4, 79, "Subtitle",ExpressionUUID->"89a06519-88bc-4c24-bcdc-3cf5948e6fb2"],
Cell[18840, 450, 2318, 57, 441, "Input",ExpressionUUID->"a72a4de1-6169-417f-a90c-2f958a0ec804"],
Cell[21161, 509, 174, 3, 46, "Input",ExpressionUUID->"0f8a6e80-535e-458f-8f24-2d38f0b5cfba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21372, 517, 313, 5, 79, "Subtitle",ExpressionUUID->"e6894912-ed91-40e9-ba0f-aa1384718b1b"],
Cell[21688, 524, 5023, 119, 750, "Input",ExpressionUUID->"09c96665-1c52-478f-b1b1-7ba0597c7748"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26748, 648, 162, 3, 79, "Subtitle",ExpressionUUID->"f2648e03-a333-4ad1-9251-3c33596375f3"],
Cell[CellGroupData[{
Cell[26935, 655, 2159, 52, 491, "Input",ExpressionUUID->"16377b35-33ba-4800-859b-956ead1199a8"],
Cell[29097, 709, 1107, 16, 52, "Output",ExpressionUUID->"71b7b544-c916-41a1-8b5a-c1a9473bfffb"],
Cell[30207, 727, 1507, 24, 52, "Output",ExpressionUUID->"69e895b5-a397-49cb-b41e-1c947126ef68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31751, 756, 3925, 95, 750, "Input",ExpressionUUID->"87d70e1a-8384-4ed7-ae50-63750b831936"],
Cell[35679, 853, 4736, 78, 298, "Output",ExpressionUUID->"8f504ef3-e010-4183-ad47-22c7fce7674a"]
}, Open  ]],
Cell[40430, 934, 620, 9, 46, "Input",ExpressionUUID->"b659e1dc-b2ff-44ff-b5c6-8f8e8e6b495f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41087, 948, 173, 3, 79, "Subtitle",ExpressionUUID->"4ea32589-fed1-467d-a85c-b761f1eafc98"],
Cell[41263, 953, 16289, 382, 4413, "Input",ExpressionUUID->"81222a0a-626e-4fcf-92c4-95ff1d695e68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57589, 1340, 227, 4, 79, "Subtitle",ExpressionUUID->"bfadcb43-6c82-4135-9a72-b61533766f00"],
Cell[57819, 1346, 2215, 33, 46, "Input",ExpressionUUID->"846aafc1-15e9-4772-9cef-b468213399b7"],
Cell[60037, 1381, 17654, 410, 3359, "Input",ExpressionUUID->"9b04790e-e563-4060-8aa5-b2e54e7f374f"],
Cell[77694, 1793, 14523, 350, 3297, "Input",ExpressionUUID->"85aa714d-8589-4ed7-a357-8d2b84f06ef0"],
Cell[92220, 2145, 14390, 350, 3231, "Input",ExpressionUUID->"1ebc1424-71cf-444c-8a16-103714f0528a"],
Cell[106613, 2497, 14539, 354, 3293, "Input",ExpressionUUID->"23359157-7356-4920-a358-987867b87bc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121189, 2856, 178, 6, 127, "Subtitle",ExpressionUUID->"2e0d64eb-fea2-4a48-99de-b750532e8f49"],
Cell[121370, 2864, 2095, 57, 190, "Input",ExpressionUUID->"951a1a2d-af81-4126-ad27-89c97b038762"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123502, 2926, 263, 5, 106, "Title",ExpressionUUID->"e4587a58-bb56-42a6-a494-50572f2c7310"],
Cell[123768, 2933, 440, 8, 46, "Input",ExpressionUUID->"d00fca7b-5c4e-47eb-bc3a-eb8be958dc1a"],
Cell[124211, 2943, 12804, 309, 2966, "Input",ExpressionUUID->"6718ac3f-ef1e-4bca-a5fc-cb52ec2374a4"],
Cell[CellGroupData[{
Cell[137040, 3256, 183, 3, 79, "Subtitle",ExpressionUUID->"1e491bf1-6ec9-4f9d-bf89-d3a1718ff6ae"],
Cell[137226, 3261, 3588, 93, 735, "Input",ExpressionUUID->"c6783c56-5960-4068-82cf-14d2805661be"]
}, Open  ]]
}, Open  ]]
}
]
*)

